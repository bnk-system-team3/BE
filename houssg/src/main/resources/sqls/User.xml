<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ssg.com.houssg.dao.UserDao">


	<!-- 닉네임 중복확인 -->
	<select id="nicknameCheck" parameterType="java.lang.String"
		resultType="java.lang.Integer">
		select count(*)
		from user
		where nickname=#{nickname}
	</select>

	<!-- 닉네임 변경 -->
	<update id="changeNickname">
		update user set nickname = #{nickname}
		where userId =
		#{userId};
	</update>

	<!-- 회원가입 -->
	<insert id="signUp" parameterType="ssg.com.houssg.dto.UserDto">
		insert into
		user(department, nickname, email, password, userId, point)
		values
		(#{department},#{nickname},#{email}, #{password}, #{userId}, 0)
	</insert>

	<!-- 로그인 -->
	<select id="login" parameterType="ssg.com.houssg.dto.UserDto"
		resultType="ssg.com.houssg.dto.UserDto">
		select userId, nickname, email, password, point, department
		from
		user
		where userId=#{userId} and password=#{password}
	</select>
	
	<!-- 마지막 로그인 날짜 업데이트 -->
	<update id="updateLastLoginDate" parameterType="ssg.com.houssg.dto.UserDto">
		UPDATE user
		SET lastLoginDate = #{lastLoginDate} 
		WHERE userId = #{userId}
	</update>

	<!-- 비밀번호 업데이트 -->
	<update id="updatePassword" parameterType="ssg.com.houssg.dto.UserDto">
		UPDATE user
		SET password = #{password} <!-- 필드 이름을 newPassword로 변경 -->
		WHERE userId = #{userId}
	</update>

	<!-- 아이디로 유저 식별 -->
	<select id="findUserById" parameterType="java.util.Map"
		resultType="ssg.com.houssg.dto.UserDto">
		SELECT *
		FROM user
		WHERE userId = #{userId}
	</select>
	
	<select id="findLanguage" parameterType="ssg.com.houssg.dto.LanguageCategoryDto"
		resultType="ssg.com.houssg.dto.LanguageCategoryDto">
		select languageId, languageName
		from
		languagecategory
	</select>


</mapper>